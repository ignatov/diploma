\subsection{Архитектура компилятора Extensible Kotlin}\label{architecture}
Компилятор Extensible Kotlin построен на основе компилятора Kotlin.

Рассмотрим стандартные шаги компиляции:
\begin{itemize}
\item[---] Лексический анализ;
\item[---] Синтаксический анализ;
\item[---] Построение внутреннего представления программы;
\item[---] Разрешение имен и анализ типов;
\item[---] Генерация байт-кода;
\end{itemize}

Существенным отличием компилятора Extensible Kotlin от компилятора Kotlin является дополнительная фаза компиляции~--- трансформация внутреннего представления программы  и последующие статические проверки. То есть шаги компиляции программы с помощью компилятора Extensible Kotlin выглядят следующим образом:
\begin{itemize}
\item[---] Лексический анализ;
\item[---] Синтаксический анализ;
\item[---] Построение внутреннего представления программы;
\item[---] Разрешение имен и анализ типов;
\item[---] Трансформация внутреннего представления программы;
\item[---] Разрешение имен и анализ типов вновь полученных структур;
\item[---] Генерация байт-кода;
\end{itemize}

\subsubsection{Расширяемые компиляторы других языков программирования}
Ряд современных языков программирования поддерживает компиляцию в несколько отдельных фаз.
В основном, такие языки являются расширениями уже существующих языков: MetaOCaml~\cite{metaocaml}, MetaMl~\cite{metaml}, 'C~\cite{extendible-c}, но есть и самостоятельные, как например, Scala~\cite{scala-spec}. 

Компиляторы таких языков позволяют управлять ходом компиляции программы с помощью специальных пользовательских расширений (Compiler Plugins~\cite{scala-compiler-plugin}). Стоит отметить, что на сегодняшний день в компиляторе языка Scala существует 21 стандартная фаза компиляции и поведение каждой из них можно изменить. Также присутствует возможность добавлять новые стадии компиляции, указывая порядок выполнения расширений.

Например, код расширения\footnote{\url{http://www.scala-lang.org/node/140}}, которое проверяет деление на ноль в явном виде, должно выполняться после стадии проверки всех ссылочных значений. Исходный код этого расширения занимает всего тридцать строк кода. Что показывает мощь и выразительность данного подхода.

По схожему принципу построена работа компилятора языка Extensible Kotlin.

\todo{Нужно подробнее.}